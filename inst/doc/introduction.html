<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Herb Susmann" />

<meta name="date" content="2016-11-28" />

<title>Introduction to RNHANES</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to RNHANES</h1>
<h4 class="author"><em>Herb Susmann</em></h4>
<h4 class="date"><em>2016-11-28</em></h4>



<p>RNHANES provides an easy way to download and analyze data from <a href="http://www.cdc.gov/nchs/nhanes.htm">NHANES</a>, the National Health and Nutrition Examination Survey conducted by the Centers for Disease Control.</p>
<p>The included analysis tools focus on the laboratory data, but the package can still be used to search for and download other types of data in NHANES.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RNHANES)</code></pre></div>
<div id="nhanes" class="section level2">
<h2>NHANES</h2>
<p>NHANES is a national survey that covers demographics, health, nutrition, and environmental chemical exposures. NHANES as a modern program started in 1999, with the survey being administered in two-year cycles.</p>
<p>The released data is split into demographic, dietary, examination, and laboratory data for each survey cycle. RNHANES is designed primarily to work with demographic and laboratory data.</p>
<p>There is one demographic data file for each survey cycle. There is a collection of laboratory data for each cycle, split into files related to different analyte groups.</p>
</div>
<div id="searching" class="section level2">
<h2>Searching</h2>
<p>First, we need to figure out what data we want to analyze and where we can find it in NHANES.</p>
<p>To find the data you’re interested in, you can search either by <em>file</em> or by <em>variable</em>. First, use RNHANES to download a list of NHANES files and the comprehensive variable list. This data isn’t bundled with the package because it is sometimes updated to fix errors or add new data. Downloading the lists lets you get the most recent versions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">files &lt;-<span class="st"> </span><span class="kw">nhanes_data_files</span>()
variables &lt;-<span class="st"> </span><span class="kw">nhanes_variables</span>()</code></pre></div>
<p>Use <code>nhanes_search</code> to search within file and variable lists. You can restrict the searches by specifying conditions on any of the columns in the list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_search</span>(files, <span class="st">&quot;environmental phenols&quot;</span>)
<span class="kw">nhanes_search</span>(files, <span class="st">&quot;pesticides&quot;</span>, component ==<span class="st"> &quot;laboratory&quot;</span>, cycle ==<span class="st"> &quot;2003-2004&quot;</span>)
<span class="kw">nhanes_search</span>(files, <span class="st">&quot;&quot;</span>, cycle ==<span class="st"> &quot;2003-2004&quot;</span>)

<span class="kw">nhanes_search</span>(variables, <span class="st">&quot;triclosan&quot;</span>)
<span class="kw">nhanes_search</span>(variables, <span class="st">&quot;DDT&quot;</span>, data_file_name ==<span class="st"> &quot;LAB28POC&quot;</span>)
<span class="kw">nhanes_search</span>(variables, <span class="st">&quot;&quot;</span>, data_file_name ==<span class="st"> &quot;EPH_E&quot;</span>)</code></pre></div>
</div>
<div id="downloading" class="section level2">
<h2>Downloading</h2>
<p>Once you’ve identified the data you need for your analysis, the next step is to download the appropriate data files from NHANES through the <code>nhanes_load_data</code> function. This function has a lot of options, so let’s start simple and go through them.</p>
<div id="downloading-one-file" class="section level3">
<h3>Downloading one file</h3>
<p>The most basic way to download data is to specify the name and cycle year of one data file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_load_data</span>(<span class="st">&quot;EPH_E&quot;</span>, <span class="st">&quot;2007-2008&quot;</span>)</code></pre></div>
<p>You can leave off the trailing suffix (e.g. the “_E&quot; in “EPH_E”) on the file name and it will be filled in for you.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_load_data</span>(<span class="st">&quot;EPH&quot;</span>, <span class="st">&quot;2007-2008&quot;</span>)</code></pre></div>
<p>To save time, <code>nhanes_load_data</code> downloads the files and saves them so they don’t need to be redownloaded every time you run your script. By default, it saves the files to a temporary directory. You can optionally set where you want the files to be downloaded to.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_load_data</span>(<span class="st">&quot;EPH&quot;</span>, <span class="st">&quot;2007-2008&quot;</span>, <span class="dt">cache =</span> <span class="st">&quot;./nhanes_data&quot;</span>)</code></pre></div>
<p>So far, we’ve been downloading the data without its accompanying demographic information, which contains demographic information like age, gender, etc. as well as the survey weights. This information is available in a separate file for each cycle. RNHANES can automatically download the correct demography file and merge it with your data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_load_data</span>(<span class="st">&quot;EPH&quot;</span>, <span class="st">&quot;2007-2008&quot;</span>, <span class="dt">cache =</span> <span class="st">&quot;./nhanes_data&quot;</span>, <span class="dt">demographics =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Some ordinal fields in NHANES are coded as numeric factors. RNHANES can decode these fields, replacing the factors with their textual description.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_load_data</span>(<span class="st">&quot;EPH&quot;</span>, <span class="st">&quot;2007-2008&quot;</span>, <span class="dt">cache =</span> <span class="st">&quot;./nhanes_data&quot;</span>, <span class="dt">demographics =</span> <span class="ot">TRUE</span>, <span class="dt">recode =</span> <span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="downloading-multiple-files" class="section level3">
<h3>Downloading multiple files</h3>
<p>You can also download multiple files from NHANES at once to simplify your code. You can do this in several ways; first, by specifying a vector of file names and cycle years. The result will be a list containing a data frame for each requested file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_load_data</span>(<span class="kw">c</span>(<span class="st">&quot;PHTHTE&quot;</span>, <span class="st">&quot;PFC&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;2007-2008&quot;</span>, <span class="st">&quot;2007-2008&quot;</span>))</code></pre></div>
<p>You can easily download all the files that were found in a search.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Search for NHANES files related to environmental phenols and download all of them</span>
results &lt;-<span class="st"> </span><span class="kw">nhanes_search</span>(files, <span class="st">&quot;environmental phenols&quot;</span>)
<span class="kw">nhanes_load_data</span>(results$data_file_name, results$cycle)

<span class="co"># Search for triclosan NHANES variables and download all related files</span>
results &lt;-<span class="st"> </span><span class="kw">nhanes_search</span>(variables, <span class="st">&quot;triclosan&quot;</span>)
<span class="kw">nhanes_load_data</span>(results$data_file_name, results$cycle)</code></pre></div>
</div>
</div>
<div id="analyzing" class="section level2">
<h2>Analyzing</h2>
<p>RNHANES includes functions to perform common analyses on NHANES data.</p>
<p>All of the analyses below will be done on the following data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Example of data loaded from one file/cycle year</span>
phenols &lt;-<span class="st"> </span><span class="kw">nhanes_load_data</span>(<span class="st">&quot;EPH&quot;</span>, <span class="st">&quot;2007-2008&quot;</span>, <span class="dt">demographics =</span> <span class="ot">TRUE</span>)

<span class="co"># Example of data loaded from multiple files/cycle years</span>
<span class="co"># Download all files that contain a &quot;triclosan&quot; variable</span>
results &lt;-<span class="st"> </span><span class="kw">nhanes_search</span>(variables, <span class="st">&quot;triclosan&quot;</span>)
triclosan &lt;-<span class="st"> </span><span class="kw">nhanes_load_data</span>(results$data_file_name, results$cycle, <span class="dt">demographics =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div id="quantiles" class="section level3">
<h3>Quantiles</h3>
<p>RNHANES uses the <code>survey</code> package to compute quantiles, taking into account survey weights. The <code>nhanes_quantile</code> abstracts this added complexity away from the user.</p>
<p>You need to specify the column name, comment column name, and weights column name for <code>nhanes_quantile</code> to work. The function returns a data frame that contains the computed quantiles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_quantile</span>(phenols, <span class="st">&quot;URXBPH&quot;</span>, <span class="st">&quot;URDBPHLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>, <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>))</code></pre></div>
<p>You can compute quantiles for multiple columns at once. The simplest way is to pass vectors for the column, comment, and weight name inputs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_quantile</span>(phenols,
                <span class="kw">c</span>(<span class="st">&quot;URXBPH&quot;</span>, <span class="st">&quot;URXTRS&quot;</span>),
                <span class="kw">c</span>(<span class="st">&quot;URDBPHLC&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>),
                <span class="kw">c</span>(<span class="st">&quot;WTSB2YR&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>),
                <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>))</code></pre></div>
<p>You can also pass in a data frame that specifies the columns to compute quantiles for.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inputs &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(
  <span class="co"># COLUMN    COMMENT     WEIGHTS</span>
   <span class="st">&quot;URXBPH&quot;</span>, <span class="st">&quot;URDBPHLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>,
   <span class="st">&quot;URXTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>
), <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(inputs) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;column&quot;</span>, <span class="st">&quot;comment_column&quot;</span>, <span class="st">&quot;weights_column&quot;</span>)

<span class="kw">nhanes_quantile</span>(phenols, inputs, <span class="dt">quantiles =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>))</code></pre></div>
<p>This looks a little awkward with only two analytes, but becomes more useful if you have a lot of analytes you want to analyze.</p>
<p><code>nhanes_quantile</code> transparently handles data that was loaded from multiple files and cycle years. The variable <code>triclosan</code> is a list of data frames; let’s compute quantiles for triclosan in each one.</p>
<p>In this case, you have to supply a data frame that specifies the columns to look at for each file name and cycle year.</p>
<p>This is a good example because for the 2003-2004 cycle, the triclosan column appears to be misnamed: it is “URDTRS”, when the naming convention in the rest of the file is to have column names start with “URX”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inputs &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(
  <span class="co"># CYCLE        COLUMN    COMMENT     WEIGHTS</span>
   <span class="st">&quot;2003-2004&quot;</span>, <span class="st">&quot;URDTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSC2YR&quot;</span>,
   <span class="st">&quot;2005-2006&quot;</span>, <span class="st">&quot;URXTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>,
   <span class="st">&quot;2007-2008&quot;</span>, <span class="st">&quot;URXTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>,
   <span class="st">&quot;2009-2010&quot;</span>, <span class="st">&quot;URXTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>,
   <span class="st">&quot;2011-2012&quot;</span>, <span class="st">&quot;URXTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSA2YR&quot;</span>
), <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(inputs) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cycle&quot;</span>, <span class="st">&quot;column&quot;</span>, <span class="st">&quot;comment_column&quot;</span>, <span class="st">&quot;weights_column&quot;</span>)

<span class="kw">nhanes_quantile</span>(triclosan, inputs, <span class="dt">quantiles =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>))</code></pre></div>
</div>
<div id="detection-frequencies" class="section level3">
<h3>Detection Frequencies</h3>
<p>Computing weighted detection frequencies works similarly to computing quantiles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_detection_frequency</span>(phenols, <span class="st">&quot;URXBPH&quot;</span>, <span class="st">&quot;URDBPHLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>)</code></pre></div>
<p>You can also pass in vectors of column names to analyze multiple analytes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_detection_frequency</span>(phenols, <span class="kw">c</span>(<span class="st">&quot;URXBPH&quot;</span>, <span class="st">&quot;URXTRS&quot;</span>),
                <span class="kw">c</span>(<span class="st">&quot;URDBPHLC&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>),
                <span class="kw">c</span>(<span class="st">&quot;WTSB2YR&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>))</code></pre></div>
<p>If you want to compute detection frequencies for columns from different files or cycles, you have to pass in a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inputs &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(
  <span class="co"># CYCLE        COLUMN    COMMENT     WEIGHTS</span>
   <span class="st">&quot;2003-2004&quot;</span>, <span class="st">&quot;URDTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSC2YR&quot;</span>,
   <span class="st">&quot;2005-2006&quot;</span>, <span class="st">&quot;URXTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>,
   <span class="st">&quot;2007-2008&quot;</span>, <span class="st">&quot;URXTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>,
   <span class="st">&quot;2009-2010&quot;</span>, <span class="st">&quot;URXTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>,
   <span class="st">&quot;2011-2012&quot;</span>, <span class="st">&quot;URXTRS&quot;</span>, <span class="st">&quot;URDTRSLC&quot;</span>, <span class="st">&quot;WTSA2YR&quot;</span>
), <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(inputs) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cycle&quot;</span>, <span class="st">&quot;column&quot;</span>, <span class="st">&quot;comment_column&quot;</span>, <span class="st">&quot;weights_column&quot;</span>)

<span class="kw">nhanes_detection_frequency</span>(triclosan, inputs)</code></pre></div>
</div>
<div id="sample-size" class="section level3">
<h3>Sample Size</h3>
<p>The <code>nhanes_sample_size</code> function computes sample sizes of one or more analytes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_sample_size</span>(phenols, <span class="st">&quot;URXBPH&quot;</span>, <span class="st">&quot;URDBPHLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>)</code></pre></div>
</div>
<div id="other-survey-statistics" class="section level3">
<h3>Other survey statistics</h3>
<p>You can use any function from the <code>survey</code> package to analyze your data through the <code>nhanes_survey</code> function. This provides a generic way to apply a survey function to NHANES data.</p>
<p>For example, you can calculate means using <code>svymean</code> as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survey)

<span class="kw">nhanes_survey</span>(svymean, phenols, <span class="st">&quot;URXBPH&quot;</span>, <span class="st">&quot;URDBPHLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="weighted-histograms" class="section level3">
<h3>Weighted histograms</h3>
<p>Use <code>nhanes_hist</code> to plot the weighted histogram of an NHANEs variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_hist</span>(phenols, <span class="st">&quot;URXBPH&quot;</span>, <span class="st">&quot;URDBPHLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>)</code></pre></div>
<p>you can transform the data before plotting the histogram by supplying a <code>transform</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nhanes_hist</span>(phenols, <span class="st">&quot;URXBPH&quot;</span>, <span class="st">&quot;URDBPHLC&quot;</span>, <span class="st">&quot;WTSB2YR&quot;</span>, <span class="dt">transform=</span><span class="st">&quot;log&quot;</span>)</code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
